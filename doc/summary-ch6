6.1 트랜잭션이란 무엇인가?
영화표를 구입하는 과정을 예로 들어보자. 
관객이나 극장이 모두 손해를 보지 않으려면 영화표 구입과 관련된 모든 작업이 하나의 트랜잭션으로 묶여 있어야 한다.
트랜잭션으로 묶이면 이 작업들은 하나의 작업 처럼 취급되어 작업이 성공하거나, 
하나라도 실패하면 모든 작업이 취소되어 아무 일도 없었던 것처럼 롤백된다.
* 영화표 예매하기
1. 좌석 검사
2. 좌석 예약
3. 지불
4. 표 발행
트랜잭션은 소프트웨어에서 데이터나 리소스들의 무결성이 깨지지 않게 하는 중요한 역할을 담당한다.
무결성은 무엇인가?

6.1.1 ACID
Atomic(원자성) 
- 트랜잭션은 여러 개의 액티비티가 하나의 작업 단위로 묶인 것
- 원사성은 트랜잭션 내의 모든 작업이 일어나거나 하나도 일어나지 않을 것을 보장
- 모든 액티비티가 성공한다면 트랜잭션이 성공한 것
- 트랜잭션 내의 액티비티 중 하나라도 실패한다면 트랜잭션이 실패하고 롤백
Consistent(무결성)
- 트랜잭션이 종료되면 시스템은 그 시스템이 모델링한 비즈니스와 무결성의 상태를 유지한다.
- 데이터는 현실과 부정합을 일으키지 않아야 한다.
Isolated(격리성)
- 트랜잭션은 여러 명의 사용자가 동일한 데이터로 작업해도 각 사용자의 작업이 서로 뒤엉키지 않게 해야 한다.
- 트랜잭션은 동일한 데이터를 도시에 읽거나 쓰지 않도록 격리되어야 한다.
- 일반적으로 데이터베이스에 있는 테이블이나 행 잠금과 관련된다.
Durable(지속성)
- 트랜잭션이 완료되면 시스템이 이상이 생기더라도 트랜잭션의 결과가 영속돼야 한다.
- 이를 위해서 결과를 데이터베이스나 다른 형태의 영속적인 저장소에 저장해야 한다.
영화표 예제를 돌이켜 보면, 어느 한 단계라도 실패하면 모든 단계의 결과를 취소함으로써 원자성을 보장
원자성은 시스템의 데이터가 일관성을 잃고 부분적으로만 처리되지 않게 해준다.
표를 구입하는 동안 다른 트랜잭션이 좌석을 빼앗지 못하게 함으로써 격리성도 확보
이 모든 결과는 지속성을 가진 저장소에 저장되어 지속성을 갖게된다.

6.1.2 스프링의 트랜잭션 관리 지원
어떤 애플리케이션이 퍼스스턴스 자원(예:데이터베이스)를 단 하나만 사용하는 경우라면, 
스프링은 해당 퍼시스턴스 매커니즘이 제공하는 트랜잭션 기능을 활용해서 트랜잭션을 처리한다

선언적 트랜잭션(스프링 AOP를 기반으로 함)은 실제 작업과 트랜잭션 규칙을 분리
스프링의 선언적 트랜잭션은 격리 수준이나 타임아웃 가튼 추가적인 애트리뷰를 선언
- 코드 내에 트랜잭션을 작성하면 트랜잭션의 범위를 세밀하게 제어해서 원하는 곳에서 시작하고 끝낼 수 있음
- 일반적으로는 이처럼 세밀한 제어를 필요로 하는 경우가 많지 않기 때문에 보통은 트랜잭션을 컨텍스트 정의 파일에 선언하는 방법을 선택



6.4 트랜잭션 선언
스프링의 선언적 트랜잭션 관리는 스프링 AOP 프레임워크를 통해 구현
트랜잭션은 본래 애플리케이션의 주요 기능의 하부를 이루는 시스템 수준의 서비스
- 스프링 사용자 입장에서는 스프링 트랜잭션을 트랜잭션 경계로 메소드를 '둘러치는(wrap)' 애스펙트로 생각하는 것이 가장 이해하기 쉽다


